{% extends 'layout.html' %}

{% block title %}Customer{% endblock %}

{% block content %}

{% with msg = get_flashed_messages() %}
  {% if msg %}
        {{ msg }}
  {% endif %}
{% endwith %}

{% if user_role == 'admin' %}



    <a href="{{ url_for('add_user_page', type='customer')}}" class="btn btn-primary">Add Customer</a>
{% endif %}

<a href="{{ url_for('home')}}">Go back</a>

<table class="table table-striped mt-5">
    <tr><th>Customer ID</th><th>Username</th><th>Customer Name</th><th>Email</th><th>Phone Number</th><th>Address</th>
        {% if user_role == 'admin' %}
        <th>Action</th>
        {% endif %}
    </tr>
    {% for customer in customer_list %}
        <tr>
                <td>{{customer['CustomerID']}}</td>
                <td><a href="/profile/{{customer['UserID']}}">{{customer['UserName']}}</a></td>
                <td><a href="/profile/{{customer['UserID']}}">{{customer['FirstName']}} {{customer['LastName']}}</a></td>
                <td>{{customer['Email']}}</td>
                <td>{{customer['PhoneNumber']}}</td>
                <td>{{customer['Address']}}</td>
                {% if user_role == 'admin' %}
                <td>

                <!-- Edit customer -->
                    <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#edit_customer">
                        Edit
                    </button>
                    
                    <div class="modal fade" id="edit_customer" tabindex="-1" aria-labelledby="edit_customer" aria-hidden="true">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h1 class="modal-title fs-5" id="edit_customer">Edit customer</h2>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                </div>
                                <div class="modal-body">
                                    <form action="{{ url_for('update_user', type=user_type)}}" method = "POST" class="needs-validation" novalidate>
                                        <div class="row g-3">
                                            <div class="col-sm-6">
                                                <label for="firstname" class="form-label">First Name</label>
                                                <input type="text" name="firstname" class="form-control" id="firstname" value="{{customer['FirstName']}}">
                                            </div>
                                        
                                            <div class="col-sm-6">
                                                <label for="lastname" class="form-label">Last Name</label>
                                                <input type="text" name="lastname" class="form-control" id="lastname" value="{{customer['LastName']}}">
                                            </div>
                                        
                                            <div class="col-sm-6">
                                                <label for="phone" class="form-label">Phone number</label>
                                                <input type="text" name="phone" class="form-control" id="phone" value="{{customer['PhoneNumber']}}">
                                            </div>
                                        
                                            <div class="col-sm-6">
                                                <label for="email" class="form-label">Email</label>
                                                <input type="text" name="email" class="form-control" id="email" value="{{customer['Email']}}" required>
                                                <div class="invalid-feedback">
                                                  Valid email is required.
                                                </div>
                                            </div>
                                        
                                            <div class="col-sm-12">
                                                <label for="address" class="form-label">Address</label>
                                                <input type="text" name="address" class="form-control" id="address" value="{{customer['Address']}}">
                                            </div>

                                            <div class="col-sm-6">
                                                <label for="username" class="form-label">Username</label>
                                                <input type="text" name="username" class="form-control" id="userName" value="{{customer['UserName']}}" required>
                                                <div class="invalid-feedback">
                                                  Valid user name is required.
                                                </div>
                                            </div>
<!--                                             
                                            <div class="input-group flex-nowrap">
                                                <span class="input-group-text" id="addon-wrapping">@</span>
                                                <input type="text" class="form-control" placeholder="Username" aria-label="Username" aria-describedby="addon-wrapping">
                                              </div> -->
                                              
                                            <div class="col-sm-6">
                                                <label for="password" class="form-label">Password</label>
                                                <input type="text" name="password" class="form-control" id="password" value="{{customer['Password']}}" required>
                                                <div class="invalid-feedback">
                                                    Valid password is required.
                                                </div>
                                            </div>
                                        </div>
                                    </form>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                                    <button type="button" class="btn btn-primary">Save changes</button>
                                </div>
                            </div>
                        </div>
                    </div>
                <!-- finish editing customer -->



                    <a href="/delete/user/{{customer['UserID']}}">Delete</a>
                </td>
                {% endif %}
        </tr>
    {% endfor %}
</table>





{% endblock %}